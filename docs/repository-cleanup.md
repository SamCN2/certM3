# CertM3 Repository Cleanup Guide

This document explains the cleanup process for removing unnecessary files from git tracking while preserving them locally.

## Overview

The CertM3 repository contains many files that shouldn't be tracked by git, including build artifacts, temporary files, and generated content. This cleanup removes these files from git tracking while keeping them available locally.

## Files Being Removed from Git Tracking

### 1. Build Artifacts & Compiled Files

**`src/app.deprecated/dist/`** - Compiled JavaScript files and source maps
- Generated from TypeScript compilation
- Can be rebuilt from source
- Includes source maps for debugging

**`src/app.deprecated/semantic/dist/`** - Semantic UI build files (~7.6MB)
- Minified CSS and JavaScript files
- Generated from Semantic UI source
- Can be rebuilt using Semantic UI build tools

**Minified and Source Map Files**
- `*.min.js` - Minified JavaScript files
- `*.min.css` - Minified CSS files  
- `*.map` - Source map files for debugging

### 2. Temporary & Backup Files

**`docs.aux/`** - Auxiliary documentation files (~56KB)
- Backup and temporary documentation files
- Includes `.bak` files and auxiliary content
- Not essential for the main documentation

**Backup Files**
- `*.bak` - Backup files created during editing
- `*.aux` - Auxiliary files from documentation processing

**Test Output Files**
- `*.output.txt` - Test output and result files
- Generated during test runs
- Can be regenerated by running tests

### 3. Lock Files

**Package Lock Files**
- `package-lock.json` - npm dependency lock files
- `yarn.lock` - Yarn dependency lock files
- Can be regenerated from `package.json` files

### 4. Environment Files

**Test Environment Files**
- `src/mw/test/test.env` - Test environment configuration
- Contains test-specific environment variables
- Should use example files instead

## Benefits of Cleanup

### Reduced Repository Size
- **Before**: ~850 tracked files
- **After**: Significantly fewer tracked files
- **Impact**: Faster git operations, smaller repository size

### Cleaner Repository
- Focus on source code and essential files
- Remove generated and temporary content
- Better separation of concerns

### Improved Development Experience
- Clearer repository structure
- Easier to identify important files
- Reduced noise in git status

## Cleanup Process

### Automated Cleanup

Use the provided cleanup script:

```bash
./scripts/cleanup-repository.sh
```

This script will:
1. Identify files to remove from tracking
2. Remove them from git (but keep locally)
3. Provide a summary of changes
4. Guide you through committing the changes

### Manual Cleanup

If you prefer manual cleanup:

```bash
# Remove build artifacts
git rm --cached -r src/app.deprecated/dist/
git rm --cached -r src/app.deprecated/semantic/dist/

# Remove temporary files
git rm --cached -r docs.aux/
git rm --cached src/api/test*.output.txt

# Remove lock files
git rm --cached package-lock.json
git rm --cached src/api/package-lock.json
git rm --cached src/app.deprecated/package-lock.json
git rm --cached src/mw/test/package-lock.json
git rm --cached tests/package-lock.json

# Remove environment files
git rm --cached src/mw/test/test.env
```

## Updated .gitignore

The `.gitignore` file has been updated to prevent these files from being tracked again:

```gitignore
# Build artifacts and compiled files
src/app.deprecated/dist/
src/app.deprecated/semantic/dist/
*.min.js
*.min.css
*.map

# Temporary and backup files
docs.aux/
*.bak
*.output.txt
*.aux

# Lock files (can be regenerated)
package-lock.json
yarn.lock

# Environment files
*.env
!src/mw/test/test.env.example
```

## Post-Cleanup Actions

### 1. Commit Changes
```bash
git add .
git commit -m "Remove unnecessary files from git tracking"
```

### 2. Verify Cleanup
```bash
git ls-files | wc -l  # Should show fewer files
git status            # Should be clean
```

### 3. Test Build Process
```bash
./scripts/verify-build.sh  # Ensure everything still works
```

## Rebuilding Removed Files

### Semantic UI Files
If you need to rebuild Semantic UI files:

```bash
cd src/app.deprecated/semantic
npm install
gulp build
```

### Compiled JavaScript
If you need to rebuild compiled JavaScript:

```bash
cd src/app.deprecated
npm install
npm run build
```

### Lock Files
If you need to regenerate lock files:

```bash
npm install  # Regenerates package-lock.json
# or
yarn install # Regenerates yarn.lock
```

## Best Practices Going Forward

1. **Don't commit build artifacts** - Let CI/CD or build scripts generate them
2. **Use .gitignore** - Keep the updated .gitignore to prevent re-tracking
3. **Document build processes** - Ensure others can rebuild removed files
4. **Regular cleanup** - Periodically review and clean up unnecessary files

## Impact on Development

### What Still Works
- All source code remains available
- Build scripts and processes unchanged
- Development workflow unaffected
- Tests and documentation intact

### What Needs Attention
- New developers need to run build steps
- CI/CD may need to generate build artifacts
- Some documentation may reference removed files

---

For questions about the cleanup process, see the [installation guide](../Install/README.md) or [base URL configuration guide](base-url-configuration.md). 